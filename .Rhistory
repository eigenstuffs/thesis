carbon_score_p <- mean(abs(permutation_coefficients$CIScore) >= abs(coef_carbon_policy))
energy_score_p <- mean(abs(permutation_coefficients$EIScore) >= abs(coef_energy_policy))
hist0 <- gghistogram(permutation_coefficients, x = "Emissions", fill = "Emissions_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = baseline_emissions), linetype = "dashed") + labs(title = "Per Capita Emissions", x = "", y = "", subtitle = paste("p =", emissions_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.04, to = .04, by = .02))
permutation_coefficients$Emissions_Bool <- ifelse(
permutation_coefficients$Emissions >= baseline_emissions,
TRUE, FALSE
)
baseline_emissions
permutation_coefficients$Emissions_Bool <- ifelse(
permutation_coefficients$Emissions >= coef_emissions,
TRUE, FALSE
)
permutation_coefficients$CarbonIntensity_Bool <- ifelse(
permutation_coefficients$CarbonIntensity >= coef_carbon,
TRUE, FALSE
)
permutation_coefficients$EnergyIntensity_Bool <- ifelse(
permutation_coefficients$EnergyIntensity >= coef_energy,
TRUE, FALSE
)
permutation_coefficients$PolicyScore_Bool <- ifelse(
permutation_coefficients$PolicyScore >= coef_policies,
TRUE, FALSE
)
permutation_coefficients$CIScore_Bool <- ifelse(
permutation_coefficients$CIScore >= coef_carbon_policy,
TRUE, FALSE
)
permutation_coefficients$EIScore_Bool <- ifelse(
permutation_coefficients$EIScore >= coef_energy_policy,
TRUE, FALSE
)
emissions_p <- mean(abs(permutation_coefficients$Emissions) >= abs(coef_emissions))
carbon_p <- mean(abs(permutation_coefficients$CarbonIntensity) >= abs(coef_carbon))
energy_p <- mean(abs(permutation_coefficients$EnergyIntensity) >= abs(coef_energy))
score_p <- mean(abs(permutation_coefficients$PolicyScore) >= abs(coef_policies))
carbon_score_p <- mean(abs(permutation_coefficients$CIScore) >= abs(coef_carbon_policy))
energy_score_p <- mean(abs(permutation_coefficients$EIScore) >= abs(coef_energy_policy))
hist0 <- gghistogram(permutation_coefficients, x = "Emissions", fill = "Emissions_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = baseline_emissions), linetype = "dashed") + labs(title = "Per Capita Emissions", x = "", y = "", subtitle = paste("p =", emissions_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.04, to = .04, by = .02))
hist1 <- gghistogram(permutation_coefficients, x = "CarbonIntensity", fill = "CarbonIntensity_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = baseline_carbon), linetype = "dashed") + labs(title = "Carbon Intensity", x = "", y = "", subtitle = paste("p =", carbon_intensity_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.02, to = .02, by = .02))
permutation_coefficients$Emissions_Bool <- ifelse(
permutation_coefficients$Emissions >= coef_emissions,
TRUE, FALSE
)
permutation_coefficients$CarbonIntensity_Bool <- ifelse(
permutation_coefficients$CarbonIntensity >= coef_carbon,
TRUE, FALSE
)
permutation_coefficients$EnergyIntensity_Bool <- ifelse(
permutation_coefficients$EnergyIntensity >= coef_energy,
TRUE, FALSE
)
permutation_coefficients$PolicyScore_Bool <- ifelse(
permutation_coefficients$PolicyScore >= coef_policies,
TRUE, FALSE
)
permutation_coefficients$CIScore_Bool <- ifelse(
permutation_coefficients$CIScore >= coef_carbon_policy,
TRUE, FALSE
)
permutation_coefficients$EIScore_Bool <- ifelse(
permutation_coefficients$EIScore >= coef_energy_policy,
TRUE, FALSE
)
emissions_p <- mean(abs(permutation_coefficients$Emissions) >= abs(coef_emissions))
carbon_p <- mean(abs(permutation_coefficients$CarbonIntensity) >= abs(coef_carbon))
energy_p <- mean(abs(permutation_coefficients$EnergyIntensity) >= abs(coef_energy))
score_p <- mean(abs(permutation_coefficients$PolicyScore) >= abs(coef_policies))
carbon_score_p <- mean(abs(permutation_coefficients$CIScore) >= abs(coef_carbon_policy))
energy_score_p <- mean(abs(permutation_coefficients$EIScore) >= abs(coef_energy_policy))
hist0 <- gghistogram(permutation_coefficients, x = "Emissions", fill = "Emissions_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = baseline_emissions), linetype = "dashed") + labs(title = "Per Capita Emissions", x = "", y = "", subtitle = paste("p =", emissions_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.04, to = .04, by = .02))
hist1 <- gghistogram(permutation_coefficients, x = "CarbonIntensity", fill = "CarbonIntensity_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = baseline_carbon), linetype = "dashed") + labs(title = "Carbon Intensity", x = "", y = "", subtitle = paste("p =", carbon_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.02, to = .02, by = .02))
hist2 <- gghistogram(permutation_coefficients, x = "EnergyIntensity", fill = "EnergyIntensity_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = baseline_energy), linetype = "dashed") + labs(title = "Energy Intensity", x = "", y = "", subtitle = paste("p =", energy_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.02, to = .02, by = .02))
hist3 <- gghistogram(permutation_coefficients, x = "PolicyScore", fill = "PolicyScore_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = baseline_policies), linetype = "dashed") + labs(title = "Climate Policy", x = "", y = "", subtitle = paste("p =", score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1))
hist4 <- gghistogram(permutation_coefficients, x = "CIScore", fill = "CIScore_Bool", color = "NA", bins = 20, label.y = F) + geom_vline(aes(xintercept = baseline_carbon_policy), linetype = "dashed") + labs(title = "Carbon Policy", x = "", y = "", subtitle = paste("p =", carbon_score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -1.5, to = 1.5, by = .5))
hist5 <- gghistogram(permutation_coefficients, x = "EIScore", fill = "EIScore_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = baseline_energy_policy), linetype = "dashed") + labs(title = "Energy Policy", x = "", y = "", subtitle = paste("p =", energy_score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -1.5, to = 1.5, by = .5))
multi.page <- ggarrange(ggarrange(hist0, legend = FALSE, ncol = 1),
ggarrange(hist1, hist2, legend = FALSE, ncol = 2), nrow = 2, common.legend = TRUE)
hist5
permutation_coefficients$Emissions_Bool <- ifelse(
permutation_coefficients$Emissions >= coef_emissions,
TRUE, FALSE
)
permutation_coefficients$CarbonIntensity_Bool <- ifelse(
permutation_coefficients$CarbonIntensity >= coef_carbon,
TRUE, FALSE
)
permutation_coefficients$EnergyIntensity_Bool <- ifelse(
permutation_coefficients$EnergyIntensity >= coef_energy,
TRUE, FALSE
)
permutation_coefficients$PolicyScore_Bool <- ifelse(
permutation_coefficients$PolicyScore >= coef_policies,
TRUE, FALSE
)
permutation_coefficients$CIScore_Bool <- ifelse(
permutation_coefficients$CIScore >= coef_carbon_policy,
TRUE, FALSE
)
permutation_coefficients$EIScore_Bool <- ifelse(
permutation_coefficients$EIScore >= coef_energy_policy,
TRUE, FALSE
)
emissions_p <- mean(abs(permutation_coefficients$Emissions) >= abs(coef_emissions))
carbon_p <- mean(abs(permutation_coefficients$CarbonIntensity) >= abs(coef_carbon))
energy_p <- mean(abs(permutation_coefficients$EnergyIntensity) >= abs(coef_energy))
score_p <- mean(abs(permutation_coefficients$PolicyScore) >= abs(coef_policies))
carbon_score_p <- mean(abs(permutation_coefficients$CIScore) >= abs(coef_carbon_policy))
energy_score_p <- mean(abs(permutation_coefficients$EIScore) >= abs(coef_energy_policy))
hist0 <- gghistogram(permutation_coefficients, x = "Emissions", fill = "Emissions_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = coef_emissions), linetype = "dashed") + labs(title = "Per Capita Emissions", x = "", y = "", subtitle = paste("p =", emissions_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.04, to = .04, by = .02))
hist1 <- gghistogram(permutation_coefficients, x = "CarbonIntensity", fill = "CarbonIntensity_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = coef_carbon), linetype = "dashed") + labs(title = "Carbon Intensity", x = "", y = "", subtitle = paste("p =", carbon_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.02, to = .02, by = .02))
hist2 <- gghistogram(permutation_coefficients, x = "EnergyIntensity", fill = "EnergyIntensity_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = coef_energy), linetype = "dashed") + labs(title = "Energy Intensity", x = "", y = "", subtitle = paste("p =", energy_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.02, to = .02, by = .02))
hist3 <- gghistogram(permutation_coefficients, x = "PolicyScore", fill = "PolicyScore_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = coef_policies), linetype = "dashed") + labs(title = "Climate Policy", x = "", y = "", subtitle = paste("p =", score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1))
hist4 <- gghistogram(permutation_coefficients, x = "CIScore", fill = "CIScore_Bool", color = "NA", bins = 20, label.y = F) + geom_vline(aes(xintercept = coef_carbon_policy), linetype = "dashed") + labs(title = "Carbon Policy", x = "", y = "", subtitle = paste("p =", carbon_score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -1.5, to = 1.5, by = .5))
hist5 <- gghistogram(permutation_coefficients, x = "EIScore", fill = "EIScore_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = coef_energy_policy), linetype = "dashed") + labs(title = "Energy Policy", x = "", y = "", subtitle = paste("p =", energy_score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -1.5, to = 1.5, by = .5))
multi.page <- ggarrange(ggarrange(hist0, legend = FALSE, ncol = 1),
ggarrange(hist1, hist2, legend = FALSE, ncol = 2), nrow = 2, common.legend = TRUE)
multi.page.2 <- ggarrange(ggarrange(hist3, legend = FALSE, ncol = 1),
ggarrange(hist4, hist5, legend = FALSE, ncol = 2), nrow = 2, common.legend = TRUE)
multi.page
multi.page.2
options(scipen=999)
library(tidyverse)
library(patchwork)
library(jtools)
library(stringr)
library(car)
library(ggpubr)
library(fixest)
library(lmtest)
set.seed(07151129)
theme_set(theme_pubr())
panel <- read.csv("panel_with_count_FEB20.csv")
permutation_coefficients <- data.frame(Emissions = rep(NA, 1000),
CarbonIntensity = rep(NA, 1000),
EnergyIntensity = rep(NA, 1000),
PolicyScore = rep(NA, 1000),
CIScore = rep(NA, 1000),
EIScore = rep(NA, 1000))
m1 <- feols(
data = panel,
fml = log(CarbonIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
m2 <- feols(
data = panel,
fml = log(EnergyIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
residuals_m1 <- resid(m1)
residual_threshold_m1 <- mean(residuals_m1) + 2*sd(residuals_m1)
observations_to_exclude_m1 <- which(abs(residuals_m1) > residual_threshold_m1)
data_reduced_m1 <- panel[-observations_to_exclude_m1, ]
residuals_m2 <- resid(m2)
residual_threshold_m2 <- mean(residuals_m2) + 2*sd(residuals_m2)
observations_to_exclude_m2 <- which(abs(residuals_m2) > residual_threshold_m2)
data_reduced_m2 <- panel[-observations_to_exclude_m2, ]
m1_no_outliers <- feols(
data = data_reduced_m1,
fml = log(CarbonIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
m2_no_outliers <- feols(
data = data_reduced_m2,
fml = log(EnergyIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
m1
m2
m1_no_outliers
m2_no_outliers
m3 <- feols(
data = panel,
fml = log(CarbonIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
m4 <- feols(
data = panel,
fml = log(EnergyIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
residuals_m3 <- resid(m3)
residual_threshold_m3 <- mean(residuals_m3) + 2*sd(residuals_m3)
observations_to_exclude_m3 <- which(abs(residuals_m3) > residual_threshold_m3)
data_reduced_m3 <- panel[-observations_to_exclude_m3, ]
residuals_m4 <- resid(m4)
residual_threshold_m4 <- mean(residuals_m4) + 2*sd(residuals_m4)
observations_to_exclude_m4 <- which(abs(residuals_m4) > residual_threshold_m4)
data_reduced_m4 <- panel[-observations_to_exclude_m4, ]
m3_no_outliers <- feols(
data = data_reduced_m3,
fml = log(CarbonIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
m4_no_outliers <- feols(
data = data_reduced_m4,
fml = log(EnergyIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
m3
m4
m3_no_outliers
m4_no_outliers
etable(m1, cluster = ~State+Year, tex = TRUE)
etable(m2,m4, cluster = ~State+Year, tex = TRUE)
etable(m1, m3, cluster = ~State+Year, tex = TRUE)
etable(m2, m4, cluster = ~State+Year, tex = TRUE)
etable(m1, m1_no_outliers, cluster = ~State+Year, tex = TRUE)
etable(m2, m2_no_outliers, cluster = ~State+Year, tex = TRUE)
multi.page <- ggarrange(ggarrange(hist0, legend = FALSE, ncol = 1),
ggarrange(hist1, hist2, legend = FALSE, ncol = 2), nrow = 2, common.legend = TRUE)
multi.page.2 <- ggarrange(ggarrange(hist3, legend = FALSE, ncol = 1),
ggarrange(hist4, hist5, legend = FALSE, ncol = 2), nrow = 2, common.legend = TRUE)
options(scipen=999)
library(tidyverse)
library(patchwork)
library(jtools)
library(stringr)
library(car)
library(ggpubr)
library(fixest)
library(lmtest)
set.seed(07151129)
theme_set(theme_pubr())
panel <- read.csv("panel_with_count_FEB20.csv")
permutation_coefficients <- data.frame(Emissions = rep(NA, 1000),
CarbonIntensity = rep(NA, 1000),
EnergyIntensity = rep(NA, 1000),
PolicyScore = rep(NA, 1000),
CIScore = rep(NA, 1000),
EIScore = rep(NA, 1000))
m1 <- feols(
data = panel,
fml = log(CarbonIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
m2 <- feols(
data = panel,
fml = log(EnergyIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
residuals_m1 <- resid(m1)
residual_threshold_m1 <- mean(residuals_m1) + 2*sd(residuals_m1)
observations_to_exclude_m1 <- which(abs(residuals_m1) > residual_threshold_m1)
data_reduced_m1 <- panel[-observations_to_exclude_m1, ]
residuals_m2 <- resid(m2)
residual_threshold_m2 <- mean(residuals_m2) + 2*sd(residuals_m2)
observations_to_exclude_m2 <- which(abs(residuals_m2) > residual_threshold_m2)
data_reduced_m2 <- panel[-observations_to_exclude_m2, ]
m1_no_outliers <- feols(
data = data_reduced_m1,
fml = log(CarbonIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
m2_no_outliers <- feols(
data = data_reduced_m2,
fml = log(EnergyIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
m1
m2
m1_no_outliers
m2_no_outliers
m3 <- feols(
data = panel,
fml = log(CarbonIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
m4 <- feols(
data = panel,
fml = log(EnergyIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
residuals_m3 <- resid(m3)
residual_threshold_m3 <- mean(residuals_m3) + 2*sd(residuals_m3)
observations_to_exclude_m3 <- which(abs(residuals_m3) > residual_threshold_m3)
data_reduced_m3 <- panel[-observations_to_exclude_m3, ]
residuals_m4 <- resid(m4)
residual_threshold_m4 <- mean(residuals_m4) + 2*sd(residuals_m4)
observations_to_exclude_m4 <- which(abs(residuals_m4) > residual_threshold_m4)
data_reduced_m4 <- panel[-observations_to_exclude_m4, ]
m3_no_outliers <- feols(
data = data_reduced_m3,
fml = log(CarbonIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
m4_no_outliers <- feols(
data = data_reduced_m4,
fml = log(EnergyIntensity) ~ Ideology + log(GDPPerCapita) + log(Population) +
Weighted_GHI + Weighted_Speed120m + PercentUrban + PropManuEmployment +
PropFarmEmployment,
vcov = ~ State + Year
)
m3
m4
m3_no_outliers
m4_no_outliers
baseline_emissions <- feols(
data = panel,
fml = log(EmissionsPerCapita) ~ Ideology | State + Year,
vcov = "twoway"
)
coef_emissions <- coef(baseline_emissions)
for(i in 1:1000) {
shuffled_data <- panel %>%
group_by(State) %>%
mutate(
order = row_number(),
shift = sample(1:n(), 1),
Ideology = Ideology[(order - shift) %% n() + 1]
) %>%
ungroup()
model <- feols(
data = shuffled_data,
fml = log(CarbonIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
permutation_coefficients$Emissions[i] <- coef(model)["Ideology"]
}
baseline_carbon <- feols(
data = panel,
fml = log(CarbonIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
coef_carbon <- coef(baseline_carbon)
for(i in 1:1000) {
shuffled_data <- panel %>%
group_by(State) %>%
mutate(
order = row_number(),
shift = sample(1:n(), 1),
Ideology = Ideology[(order - shift) %% n() + 1]
) %>%
ungroup()
model <- feols(
data = shuffled_data,
fml = log(CarbonIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
permutation_coefficients$CarbonIntensity[i] <- coef(model)["Ideology"]
}
baseline_energy <- feols(
data = panel,
fml = log(EnergyIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
coef_energy <- coef(baseline_energy)
for(i in 1:1000) {
shuffled_data <- panel %>%
group_by(State) %>%
mutate(
order = row_number(),
shift = sample(1:n(), 1),
Ideology = Ideology[(order - shift) %% n() + 1]
) %>%
ungroup()
model <- feols(
data = shuffled_data,
fml = log(EnergyIntensity) ~ Ideology | State + Year,
vcov = "twoway"
)
permutation_coefficients$EnergyIntensity[i] <- coef(model)["Ideology"]
}
baseline_policies <- feols(
data = panel,
fml = Score ~ Ideology | State + Year,
vcov = "twoway"
)
coef_policies <- coef(baseline_policies)
for(i in 1:1000) {
shuffled_data <- panel %>%
group_by(State) %>%
mutate(
order = row_number(),
shift = sample(1:n(), 1),
Ideology = Ideology[(order - shift) %% n() + 1]
) %>%
ungroup()
model <- feols(
data = shuffled_data,
fml = Score ~ Ideology | State + Year,
vcov = "twoway"
)
permutation_coefficients$PolicyScore[i] <- coef(model)["Ideology"]
}
baseline_carbon_policy <- feols(
data = panel,
fml = CI_Score ~ Ideology | State + Year,
vcov = "twoway"
)
coef_carbon_policy <- coef(baseline_carbon_policy)
for(i in 1:1000) {
shuffled_data <- panel %>%
group_by(State) %>%
mutate(
order = row_number(),
shift = sample(1:n(), 1),
Ideology = Ideology[(order - shift) %% n() + 1]
) %>%
ungroup()
model <- feols(
data = shuffled_data,
fml = CI_Score ~ Ideology | State + Year,
vcov = "twoway"
)
permutation_coefficients$CIScore[i] <- coef(model)["Ideology"]
}
baseline_energy_policy <- feols(
data = panel,
fml = EE_Score ~ Ideology | State + Year,
vcov = "twoway"
)
coef_energy_policy <- coef(baseline_energy_policy)
for(i in 1:1000) {
shuffled_data <- panel %>%
group_by(State) %>%
mutate(
order = row_number(),
shift = sample(1:n(), 1),
Ideology = Ideology[(order - shift) %% n() + 1]
) %>%
ungroup()
model <- feols(
data = shuffled_data,
fml = EE_Score ~ Ideology | State + Year,
vcov = "twoway"
)
permutation_coefficients$EIScore[i] <- coef(model)["Ideology"]
}
permutation_coefficients$Emissions_Bool <- ifelse(
permutation_coefficients$Emissions >= coef_emissions,
TRUE, FALSE
)
permutation_coefficients$CarbonIntensity_Bool <- ifelse(
permutation_coefficients$CarbonIntensity >= coef_carbon,
TRUE, FALSE
)
permutation_coefficients$EnergyIntensity_Bool <- ifelse(
permutation_coefficients$EnergyIntensity >= coef_energy,
TRUE, FALSE
)
permutation_coefficients$PolicyScore_Bool <- ifelse(
permutation_coefficients$PolicyScore >= coef_policies,
TRUE, FALSE
)
permutation_coefficients$CIScore_Bool <- ifelse(
permutation_coefficients$CIScore >= coef_carbon_policy,
TRUE, FALSE
)
permutation_coefficients$EIScore_Bool <- ifelse(
permutation_coefficients$EIScore >= coef_energy_policy,
TRUE, FALSE
)
emissions_p <- mean(abs(permutation_coefficients$Emissions) >= abs(coef_emissions))
carbon_p <- mean(abs(permutation_coefficients$CarbonIntensity) >= abs(coef_carbon))
energy_p <- mean(abs(permutation_coefficients$EnergyIntensity) >= abs(coef_energy))
score_p <- mean(abs(permutation_coefficients$PolicyScore) >= abs(coef_policies))
carbon_score_p <- mean(abs(permutation_coefficients$CIScore) >= abs(coef_carbon_policy))
energy_score_p <- mean(abs(permutation_coefficients$EIScore) >= abs(coef_energy_policy))
hist0 <- gghistogram(permutation_coefficients, x = "Emissions", fill = "Emissions_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = coef_emissions), linetype = "dashed") + labs(title = "Per Capita Emissions", x = "", y = "", subtitle = paste("p =", emissions_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.04, to = .04, by = .02))
hist1 <- gghistogram(permutation_coefficients, x = "CarbonIntensity", fill = "CarbonIntensity_Bool", color = "NA", bins = 20) +  geom_vline(aes(xintercept = coef_carbon), linetype = "dashed") + labs(title = "Carbon Intensity", x = "", y = "", subtitle = paste("p =", carbon_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.02, to = .02, by = .02))
hist2 <- gghistogram(permutation_coefficients, x = "EnergyIntensity", fill = "EnergyIntensity_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = coef_energy), linetype = "dashed") + labs(title = "Energy Intensity", x = "", y = "", subtitle = paste("p =", energy_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -.02, to = .02, by = .02))
hist3 <- gghistogram(permutation_coefficients, x = "PolicyScore", fill = "PolicyScore_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = coef_policies), linetype = "dashed") + labs(title = "Climate Policy", x = "", y = "", subtitle = paste("p =", score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -4, to = 1, by = 1))
hist4 <- gghistogram(permutation_coefficients, x = "CIScore", fill = "CIScore_Bool", color = "NA", bins = 20, label.y = F) + geom_vline(aes(xintercept = coef_carbon_policy), linetype = "dashed") + labs(title = "Carbon Policy", x = "", y = "", subtitle = paste("p =", carbon_score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -1.5, to = 1.5, by = .5))
hist5 <- gghistogram(permutation_coefficients, x = "EIScore", fill = "EIScore_Bool", color = "NA", bins = 20) + geom_vline(aes(xintercept = coef_energy_policy), linetype = "dashed") + labs(title = "Energy Policy", x = "", y = "", subtitle = paste("p =", energy_score_p), 'fill' = "Above baseline?") + theme_replace(axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + scale_x_continuous(breaks = seq(from = -1.5, to = 1.5, by = .5))
multi.page <- ggarrange(ggarrange(hist0, legend = FALSE, ncol = 1),
ggarrange(hist1, hist2, legend = FALSE, ncol = 2), nrow = 2, common.legend = TRUE)
multi.page.2 <- ggarrange(ggarrange(hist3, legend = FALSE, ncol = 1),
ggarrange(hist4, hist5, legend = FALSE, ncol = 2), nrow = 2, common.legend = TRUE)
ggexport(multi.page, filename = "multi.page.pdf")
ggexport(multi.page.2, filename = "multi.page.2.pdf")
etable(m1, m1_no_outliers, cluster = ~State+Year, tex = TRUE)
etable(m2, m2_no_outliers, cluster = ~State+Year, tex = TRUE)
etable(m3, m3_no_outliers, cluster = ~State+Year, tex = TRUE)
etable(m4, m4_no_outliers, cluster = ~State+Year, tex = TRUE)
etable(m3, m3_no_outliers, cluster = ~State+Year, tex = TRUE)
etable(m4, m4_no_outliers, cluster = ~State+Year, tex = TRUE)
