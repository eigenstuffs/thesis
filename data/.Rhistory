"SD", "TN", "TX", "UT", "VT",
"VA", "WA", "WV", "WI", "WY"
)
)
ci <- ci[5:56,]
colnames(ci) <- ci[1,]
ci <- ci[2:52,1:53]
ei <- ei[2:53,]
colnames(ei) <- ei[1,]
ei <- ei[2:52,1:63]
renewables <- renewables[,1:26]
colnames(energy) <- energy[2,]
energy <- energy[3:53,1:63]
colnames(gdpcurrent) <- gdpcurrent[2,]
gdpcurrent <- gdpcurrent[3:53,1:26]
colnames(ng) <- ng[2,]
ng <- ng[3:53,1:63]
colnames(union) <- union[2,]
union <- union[3:10202,]
colnames(wages) <- wages[3,]
wages <- wages[4:156,]
colnames(incpc) <- incpc[3,]
incpc <- incpc[4:54,2:25]
colnames(pop) <- pop[2,]
pop <- pop[3:53,1:63]
production <- production[production$StateCode!=c("X3","X3","X4","X5"),]
production <- production[production$MSN==c("CLPRB","NGMPB","PAPRB","TETCB"),]
production <- production[,c(2,3,42:64)]
coal_prod <- production[production$MSN=="CLPRB",]
natgas_prod <- production[production$MSN=="NGMPB",]
crude_prod <- production[production$MSN=="PAPRB",]
total_prod <- production[production$MSN=="TETCB",]
prices <- prices[prices$MSN==c("CLTCD","NGTCD","PATCD","TETCD"),]
prices <- prices[,c(2,3,32:54)]
coal_price <- prices[prices$MSN=="CLTCD",]
natgas_price <- prices[prices$MSN=="NGTCD",]
crude_price <- prices[prices$MSN=="PATCD",]
total_price <- prices[prices$MSN=="TETCD",]
coal_prod <- coal_prod[,c(1,3:ncol(coal_prod))]
natgas_prod <- natgas_prod[,c(1,3:ncol(natgas_prod))]
crude_prod <- crude_prod[,c(1,3:ncol(crude_prod))]
total_prod <- total_prod[,c(1,3:ncol(total_prod))]
coal_price <- coal_price[,c(1,3:ncol(coal_price))]
natgas_price <- natgas_price[,c(1,3:ncol(natgas_price))]
crude_price <- crude_price[,c(1,3:ncol(crude_price))]
total_price <- total_price[,c(1,3:ncol(total_price))]
total <- wages[wages$LineCode=="50",]
farm <- wages[wages$LineCode=="81",]
mining <- wages[wages$LineCode=="200",]
total <- total[,c(2,5:27)]
farm <- farm[,c(2,5:27)]
mining <- mining[,c(2,5:27)]
ci <- melt(ci, id = "State")
ei <- melt(ei, id = "State")
energy <- melt(energy, id = "State")
gdpcurrent <- melt(gdpcurrent, id = "State")
renewables <- melt(renewables, id = "State")
ng <- melt(ng, id = "State")
total <- melt(total, id = "GeoName")
farm <- melt(farm, id = "GeoName")
mining <- melt(mining, id = "GeoName")
pop <- melt(pop, id = "State")
incpc <- melt(incpc, id = "GeoName")
union <- union[union$Sector == "Priv. Manufacturing",]
union <- as.data.frame(cbind(union$State, union$Year, union$`Membership Rate`))
union$V3 <- as.numeric(gsub("%","",union$V3))/100
str(union)
coal_prod <- melt(coal_prod, id = "StateCode")
natgas_prod <- melt(natgas_prod, id = "StateCode")
crude_prod <- melt(crude_prod, id = "StateCode")
total_prod <- melt(total_prod, id = "StateCode")
coal_price <- melt(coal_price, id = "State")
natgas_price <- melt(natgas_price, id = "State")
crude_price <- melt(crude_price, id = "State")
total_price <- melt(total_price, id = "State")
list <- list(ci, ei, energy, gdpcurrent, renewables, ng, total, farm, mining, pop, incpc, union)
convert_state_name <- function(state_name) {
if (state_name %in% state_mapping$Full_State) {
return(state_mapping$Abbreviation[match(state_name, state_mapping$Full_State)])
} else {
return(state_name)
}
}
p <- data.frame()
list <- lapply(list, function(df) {
colnames(df) <- c("State", "Year", "Value")
df$State <- gsub("*", "", df$State)
df$State <- gsub(" ", "", df$State)
df$State <- sapply(df$State, convert_state_name)
df <- df[df$State != "US",]
df$Year <- gsub("X", "", df$Year)
df$Year <- as.numeric(df$Year)
df$Value <- gsub(",","",df$Value)
df$Value <- as.numeric(df$Value)
df <- df[df$Year>=1998&df$Year<=2020,]
return(df)
})
list[[11]][list[[11]]$State=="Alaska*",]$State <- "AK"
list[[11]][list[[11]]$State=="Hawaii*",]$State <- "HI"
p <- Reduce(function(x, y) merge(x, y, by=c("State", "Year"), all = TRUE), list)
unique(p$State)
ideology <- as.data.frame(cbind(ideology$st, ideology$year, ideology$hou_chamber, ideology$sen_chamber))
colnames(ideology) <- c("State","Year","House","Senate")
ideology$House <- as.numeric(ideology$House)
ideology$Senate <- as.numeric(ideology$Senate)
ideology$Chamber <- ideology$Senate
str(ideology)
for (i in 1:nrow(ideology)) {
if (!is.na(ideology[i,3]) && !is.na(ideology[i,4])) {
ideology[i,5] <- (ideology[i,3] + ideology[i,4])/2
}
}
states$State <- rownames(states)
states$State <- gsub(" ","",states$State)
states$State <- sapply(states$State,convert_state_name)
states <- states[states$State!="DC",]
states <- subset(states, select = c("State", "Area"))
ideology <- ideology[ideology$Year >= 1998 & ideology$Year <= 2020,]
p <- merge(ideology, p, by=c("State","Year"))
p <- merge(p, states, by="State")
colnames(p) <- c("State","Year","House","Senate","Chamber","CI","EI","TotalEnergy","GDPCurrent","Renewables","NatGas","TotalWages","FarmWages","MiningWages","Population","IncomePC","ManuUnion","Area")
p$FarmWages <- p$FarmWages/p$TotalWages
p$MiningWages <- p$MiningWages/p$TotalWages
p$Renewables <- p$Renewables/p$TotalEnergy
p$NatGas <- p$NatGas/p$TotalEnergy
p$PopDens <- p$Population/p$Area
p$GDPCurrent <- p$GDPCurrent/p$Population
p <- subset(p, select = c(-House,-Senate,-TotalEnergy,-TotalWages,-Area))
p$Chamber <- p$Chamber + 10
p$Chamber <- log(p$Chamber)
p$CI <- log(p$CI)
p$EI <- log(p$EI)
p$GDPCurrent <- log(p$GDPCurrent)
p$Renewables <- log(p$Renewables+1)
p$NatGas <- log(p$NatGas+1)
p$FarmWages <- log(p$FarmWages)
p$MiningWages <- log(p$MiningWages)
p$IncomePC <- log(p$IncomePC)
p$ManuUnion <- log(p$ManuUnion+1)
p$PopDens <- log(p$PopDens)
p <- pdata.frame(p)
p$CI_Lag1 <- lag(p$CI, 1)
p$CI_Lag2 <- lag(p$CI, 2)
p$EI_Lag1 <- lag(p$EI, 1)
p$EI_Lag2 <- lag(p$EI, 2)
p$ID <- rownames(p)
write.csv(p, "panel.csv")
#p <- as.data.frame(lapply(p, sample))
p_omit <- na.omit(p)
m1 <- lm(data = p_omit,
formula = CI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + Population + factor(State) + factor(Year))
coeftest(m1, vcov. = vcovHC(m1, "HC3"))
m2 <- lm(data = p_omit,
formula = EI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + Population + factor(State) + factor(Year))
coeftest(m2, vcov. = vcovHC(m2, "HC3"))
cooks_1 <- cooks.distance(m1)
threshold <- 4/length(cooks_1)
p_subset_1 <- p_omit[cooks_1 <= threshold, ]
cooks_2 <- cooks.distance(m2)
threshold <- 4/length(cooks_2)
p_subset_2 <- p_omit[cooks_2 <= threshold, ]
m3 <- lm(data = p_subset_1,
formula = CI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m3, vcov. = vcovHC(m3, "HC3"))
m4 <- lm(data = p_subset_2,
formula = EI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m4, vcov. = vcovHC(m4, "HC3"))
m5 <- lm(data = p_omit,
formula = CI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m5, vcov. = vcovHC(m5, "HC3"))
m6 <- lm(data = p_omit,
formula = EI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m6, vcov. = vcovHC(m6, "HC3"))
cooks_3 <- cooks.distance(m5)
threshold <- 4/length(cooks_3)
p_subset_3 <- p_omit[cooks_3 <= threshold, ]
cooks_4 <- cooks.distance(m6)
threshold <- 4/length(cooks_4)
p_subset_4 <- p_omit[cooks_4 <= threshold, ]
m7 <- lm(data = p_subset_3,
formula = CI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m7, vcov. = vcovHC(m7, "HC3"))
m8 <- lm(data = p_subset_4,
formula = EI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m8, vcov. = vcovHC(m8, "HC3"))
m9 <- lm(data = p_omit,
formula = CI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m9, vcov. = vcovHC(m9, "HC3"))
m10 <- lm(data = p_omit,
formula = EI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m10, vcov. = vcovHC(m10, "HC3"))
cooks_5 <- cooks.distance(m9)
threshold <- 4/length(cooks_5)
p_subset_5 <- p_omit[cooks_5 <= threshold, ]
cooks_6 <- cooks.distance(m10)
threshold <- 4/length(cooks_6)
p_subset_6 <- p_omit[cooks_6 <= threshold, ]
m11 <- lm(data = p_subset_5,
formula = CI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m11, vcov. = vcovHC(m11, "HC3"))
m12 <- lm(data = p_subset_6,
formula = EI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m12, vcov. = vcovHC(m12, "HC3"))
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
summary(m6)
summary(m7)
summary(m8)
summary(m9)
summary(m10)
summary(m11)
summary(m12)
coeftest(m1, vcov. = vcovHC(m1, "HC3"))
coeftest(m2, vcov. = vcovHC(m2, "HC3"))
vif(m1)
m1 <- lm(data = p_omit,
formula = CI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + Population)
vif(m1)
m1 <- lm(data = p_omit,
formula = CI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + Population + factor(State) + factor(Year))
coeftest(m1, vcov. = vcovHC(m1, "HC3"))
coeftest(m2, vcov. = vcovHC(m2, "HC3"))
options(scipen=999)
library(tidyverse)
library(haven)
library(reshape)
library(plm)
library(lmtest)
library(sandwich)
library(car)
library(mgcv)
ci <- read.csv("data/raw_ci.csv")
ei <- read.csv("data/raw_ei.csv")
energy <- read.csv("data/raw_consumption.csv")
gdpcurrent <- read.csv("data/raw_currentgdp.csv")
renewables <- read.csv("data/raw_renewables.csv")
ng <- read.csv("data/raw_ng.csv")
union <- read.csv("data/raw_union.csv")
wages <- read.csv("data/raw_wage.csv")
incpc <- read.csv("data/raw_inc.csv")
pop <- read.csv("data/raw_pop.csv")
ideology <- read_dta("data/raw_shormccarty.dta")
production <- read.csv("data/raw_production.csv")
prices <- read.csv("data/raw_prices.csv")
states <- as.data.frame(state.x77)
state_mapping <- data.frame(
Full_State = c(
"Alabama", "Alaska", "Arizona", "Arkansas", "California",
"Colorado", "Connecticut", "Delaware",  "DistrictofColumbia", "Florida", "Georgia",
"Hawaii", "Idaho", "Illinois", "Indiana", "Iowa",
"Kansas", "Kentucky", "Louisiana", "Maine", "Maryland",
"Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri",
"Montana", "Nebraska", "Nevada", "NewHampshire", "NewJersey",
"NewMexico", "NewYork", "NorthCarolina", "NorthDakota", "Ohio",
"Oklahoma", "Oregon", "Pennsylvania", "RhodeIsland", "SouthCarolina",
"SouthDakota", "Tennessee", "Texas", "Utah", "Vermont",
"Virginia", "Washington", "WestVirginia", "Wisconsin", "Wyoming"
),
Abbreviation = c(
"AL", "AK", "AZ", "AR", "CA",
"CO", "CT", "DE", "DC", "FL", "GA",
"HI", "ID", "IL", "IN", "IA",
"KS", "KY", "LA", "ME", "MD",
"MA", "MI", "MN", "MS", "MO",
"MT", "NE", "NV", "NH", "NJ",
"NM", "NY", "NC", "ND", "OH",
"OK", "OR", "PA", "RI", "SC",
"SD", "TN", "TX", "UT", "VT",
"VA", "WA", "WV", "WI", "WY"
)
)
ci <- ci[5:56,]
colnames(ci) <- ci[1,]
ci <- ci[2:52,1:53]
ei <- ei[2:53,]
colnames(ei) <- ei[1,]
ei <- ei[2:52,1:63]
renewables <- renewables[,1:26]
colnames(energy) <- energy[2,]
energy <- energy[3:53,1:63]
colnames(gdpcurrent) <- gdpcurrent[2,]
gdpcurrent <- gdpcurrent[3:53,1:26]
colnames(ng) <- ng[2,]
ng <- ng[3:53,1:63]
colnames(union) <- union[2,]
union <- union[3:10202,]
colnames(wages) <- wages[3,]
wages <- wages[4:156,]
colnames(incpc) <- incpc[3,]
incpc <- incpc[4:54,2:25]
colnames(pop) <- pop[2,]
pop <- pop[3:53,1:63]
production <- production[production$StateCode!=c("X3","X3","X4","X5"),]
production <- production[production$MSN==c("CLPRB","NGMPB","PAPRB","TETCB"),]
production <- production[,c(2,3,42:64)]
coal_prod <- production[production$MSN=="CLPRB",]
natgas_prod <- production[production$MSN=="NGMPB",]
crude_prod <- production[production$MSN=="PAPRB",]
total_prod <- production[production$MSN=="TETCB",]
prices <- prices[prices$MSN==c("CLTCD","NGTCD","PATCD","TETCD"),]
prices <- prices[,c(2,3,32:54)]
coal_price <- prices[prices$MSN=="CLTCD",]
natgas_price <- prices[prices$MSN=="NGTCD",]
crude_price <- prices[prices$MSN=="PATCD",]
total_price <- prices[prices$MSN=="TETCD",]
coal_prod <- coal_prod[,c(1,3:ncol(coal_prod))]
natgas_prod <- natgas_prod[,c(1,3:ncol(natgas_prod))]
crude_prod <- crude_prod[,c(1,3:ncol(crude_prod))]
total_prod <- total_prod[,c(1,3:ncol(total_prod))]
coal_price <- coal_price[,c(1,3:ncol(coal_price))]
natgas_price <- natgas_price[,c(1,3:ncol(natgas_price))]
crude_price <- crude_price[,c(1,3:ncol(crude_price))]
total_price <- total_price[,c(1,3:ncol(total_price))]
total <- wages[wages$LineCode=="50",]
farm <- wages[wages$LineCode=="81",]
mining <- wages[wages$LineCode=="200",]
total <- total[,c(2,5:27)]
farm <- farm[,c(2,5:27)]
mining <- mining[,c(2,5:27)]
ci <- melt(ci, id = "State")
ei <- melt(ei, id = "State")
energy <- melt(energy, id = "State")
gdpcurrent <- melt(gdpcurrent, id = "State")
renewables <- melt(renewables, id = "State")
ng <- melt(ng, id = "State")
total <- melt(total, id = "GeoName")
farm <- melt(farm, id = "GeoName")
mining <- melt(mining, id = "GeoName")
pop <- melt(pop, id = "State")
incpc <- melt(incpc, id = "GeoName")
union <- union[union$Sector == "Priv. Manufacturing",]
union <- as.data.frame(cbind(union$State, union$Year, union$`Membership Rate`))
union$V3 <- as.numeric(gsub("%","",union$V3))/100
str(union)
coal_prod <- melt(coal_prod, id = "StateCode")
natgas_prod <- melt(natgas_prod, id = "StateCode")
crude_prod <- melt(crude_prod, id = "StateCode")
total_prod <- melt(total_prod, id = "StateCode")
coal_price <- melt(coal_price, id = "State")
natgas_price <- melt(natgas_price, id = "State")
crude_price <- melt(crude_price, id = "State")
total_price <- melt(total_price, id = "State")
list <- list(ci, ei, energy, gdpcurrent, renewables, ng, total, farm, mining, pop, incpc, union)
convert_state_name <- function(state_name) {
if (state_name %in% state_mapping$Full_State) {
return(state_mapping$Abbreviation[match(state_name, state_mapping$Full_State)])
} else {
return(state_name)
}
}
p <- data.frame()
list <- lapply(list, function(df) {
colnames(df) <- c("State", "Year", "Value")
df$State <- gsub("*", "", df$State)
df$State <- gsub(" ", "", df$State)
df$State <- sapply(df$State, convert_state_name)
df <- df[df$State != "US",]
df$Year <- gsub("X", "", df$Year)
df$Year <- as.numeric(df$Year)
df$Value <- gsub(",","",df$Value)
df$Value <- as.numeric(df$Value)
df <- df[df$Year>=1998&df$Year<=2020,]
return(df)
})
list[[11]][list[[11]]$State=="Alaska*",]$State <- "AK"
list[[11]][list[[11]]$State=="Hawaii*",]$State <- "HI"
p <- Reduce(function(x, y) merge(x, y, by=c("State", "Year"), all = TRUE), list)
unique(p$State)
ideology <- as.data.frame(cbind(ideology$st, ideology$year, ideology$hou_chamber, ideology$sen_chamber))
colnames(ideology) <- c("State","Year","House","Senate")
ideology$House <- as.numeric(ideology$House)
ideology$Senate <- as.numeric(ideology$Senate)
ideology$Chamber <- ideology$Senate
str(ideology)
for (i in 1:nrow(ideology)) {
if (!is.na(ideology[i,3]) && !is.na(ideology[i,4])) {
ideology[i,5] <- (ideology[i,3] + ideology[i,4])/2
}
}
states$State <- rownames(states)
states$State <- gsub(" ","",states$State)
states$State <- sapply(states$State,convert_state_name)
states <- states[states$State!="DC",]
states <- subset(states, select = c("State", "Area"))
ideology <- ideology[ideology$Year >= 1998 & ideology$Year <= 2020,]
p <- merge(ideology, p, by=c("State","Year"))
p <- merge(p, states, by="State")
colnames(p) <- c("State","Year","House","Senate","Chamber","CI","EI","TotalEnergy","GDPCurrent","Renewables","NatGas","TotalWages","FarmWages","MiningWages","Population","IncomePC","ManuUnion","Area")
p$FarmWages <- p$FarmWages/p$TotalWages
p$MiningWages <- p$MiningWages/p$TotalWages
p$Renewables <- p$Renewables/p$TotalEnergy
p$NatGas <- p$NatGas/p$TotalEnergy
p$PopDens <- p$Population/p$Area
p$GDPCurrent <- p$GDPCurrent/p$Population
p <- subset(p, select = c(-House,-Senate,-TotalEnergy,-TotalWages,-Area))
p$Chamber <- p$Chamber + 10
p$Chamber <- log(p$Chamber)
p$CI <- log(p$CI)
p$EI <- log(p$EI)
p$GDPCurrent <- log(p$GDPCurrent)
p$Renewables <- log(p$Renewables+1)
p$NatGas <- log(p$NatGas+1)
p$FarmWages <- log(p$FarmWages)
p$MiningWages <- log(p$MiningWages)
p$IncomePC <- log(p$IncomePC)
p$ManuUnion <- log(p$ManuUnion+1)
p$PopDens <- log(p$PopDens)
p$Population <- log(p$Population)
p <- pdata.frame(p)
p$CI_Lag1 <- lag(p$CI, 1)
p$CI_Lag2 <- lag(p$CI, 2)
p$EI_Lag1 <- lag(p$EI, 1)
p$EI_Lag2 <- lag(p$EI, 2)
p$ID <- rownames(p)
write.csv(p, "panel.csv")
#p <- as.data.frame(lapply(p, sample))
p_omit <- na.omit(p)
m1 <- lm(data = p_omit,
formula = CI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + Population + factor(State) + factor(Year))
coeftest(m1, vcov. = vcovHC(m1, "HC3"))
m2 <- lm(data = p_omit,
formula = EI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + Population + factor(State) + factor(Year))
coeftest(m2, vcov. = vcovHC(m2, "HC3"))
cooks_1 <- cooks.distance(m1)
threshold <- 4/length(cooks_1)
p_subset_1 <- p_omit[cooks_1 <= threshold, ]
cooks_2 <- cooks.distance(m2)
threshold <- 4/length(cooks_2)
p_subset_2 <- p_omit[cooks_2 <= threshold, ]
m3 <- lm(data = p_subset_1,
formula = CI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m3, vcov. = vcovHC(m3, "HC3"))
m4 <- lm(data = p_subset_2,
formula = EI ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m4, vcov. = vcovHC(m4, "HC3"))
m5 <- lm(data = p_omit,
formula = CI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m5, vcov. = vcovHC(m5, "HC3"))
m6 <- lm(data = p_omit,
formula = EI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m6, vcov. = vcovHC(m6, "HC3"))
cooks_3 <- cooks.distance(m5)
threshold <- 4/length(cooks_3)
p_subset_3 <- p_omit[cooks_3 <= threshold, ]
cooks_4 <- cooks.distance(m6)
threshold <- 4/length(cooks_4)
p_subset_4 <- p_omit[cooks_4 <= threshold, ]
m7 <- lm(data = p_subset_3,
formula = CI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m7, vcov. = vcovHC(m7, "HC3"))
m8 <- lm(data = p_subset_4,
formula = EI_Lag1 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m8, vcov. = vcovHC(m8, "HC3"))
m9 <- lm(data = p_omit,
formula = CI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m9, vcov. = vcovHC(m9, "HC3"))
m10 <- lm(data = p_omit,
formula = EI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m10, vcov. = vcovHC(m10, "HC3"))
cooks_5 <- cooks.distance(m9)
threshold <- 4/length(cooks_5)
p_subset_5 <- p_omit[cooks_5 <= threshold, ]
cooks_6 <- cooks.distance(m10)
threshold <- 4/length(cooks_6)
p_subset_6 <- p_omit[cooks_6 <= threshold, ]
m11 <- lm(data = p_subset_5,
formula = CI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m11, vcov. = vcovHC(m11, "HC3"))
m12 <- lm(data = p_subset_6,
formula = EI_Lag2 ~ Chamber + Renewables + NatGas + FarmWages + MiningWages + IncomePC
+ ManuUnion + PopDens + factor(State) + factor(Year))
coeftest(m12, vcov. = vcovHC(m12, "HC3"))
summary(m1)
summary(m2)
summary(m3)
summary(m4)
summary(m5)
summary(m6)
summary(m7)
summary(m8)
summary(m9)
summary(m10)
summary(m11)
summary(m12)
